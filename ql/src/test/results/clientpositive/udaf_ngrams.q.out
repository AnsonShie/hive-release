PREHOOK: query: CREATE TABLE kafka (contents STRING)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@kafka
POSTHOOK: query: CREATE TABLE kafka (contents STRING)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@kafka
PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/text-en.txt' INTO TABLE kafka
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@kafka
POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/text-en.txt' INTO TABLE kafka
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@kafka
PREHOOK: query: SELECT ngrams(sentences(lower(contents)), 1, 100, 1000).estfrequency FROM kafka
PREHOOK: type: QUERY
PREHOOK: Input: default@kafka
#### A masked pattern was here ####
POSTHOOK: query: SELECT ngrams(sentences(lower(contents)), 1, 100, 1000).estfrequency FROM kafka
POSTHOOK: type: QUERY
POSTHOOK: Input: default@kafka
#### A masked pattern was here ####
[267.0,171.0,164.0,119.0,108.0,106.0,106.0,82.0,79.0,67.0,67.0,46.0,45.0,42.0,42.0,40.0,39.0,37.0,37.0,36.0,34.0,32.0,32.0,30.0,30.0,29.0,28.0,28.0,28.0,28.0,26.0,25.0,24.0,23.0,23.0,22.0,22.0,21.0,20.0,19.0,18.0,18.0,18.0,17.0,17.0,17.0,16.0,16.0,16.0,16.0,15.0,15.0,14.0,14.0,14.0,13.0,13.0,13.0,13.0,13.0,13.0,13.0,12.0,12.0,12.0,12.0,12.0,12.0,12.0,11.0,11.0,11.0,11.0,11.0,11.0,11.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,9.0,8.0]
PREHOOK: query: SELECT ngrams(sentences(lower(contents)), 2, 100, 1000).estfrequency FROM kafka
PREHOOK: type: QUERY
PREHOOK: Input: default@kafka
#### A masked pattern was here ####
POSTHOOK: query: SELECT ngrams(sentences(lower(contents)), 2, 100, 1000).estfrequency FROM kafka
POSTHOOK: type: QUERY
POSTHOOK: Input: default@kafka
#### A masked pattern was here ####
[23.0,20.0,18.0,17.0,17.0,16.0,16.0,16.0,16.0,15.0,14.0,13.0,12.0,12.0,12.0,11.0,11.0,11.0,10.0,10.0,10.0,10.0,10.0,10.0,9.0,9.0,9.0,8.0,8.0,8.0,8.0,7.0,7.0,7.0,7.0,7.0,7.0,7.0,7.0,6.0,6.0,6.0,6.0,6.0,6.0,6.0,6.0,6.0,6.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0]
PREHOOK: query: SELECT ngrams(sentences(lower(contents)), 3, 100, 1000).estfrequency FROM kafka
PREHOOK: type: QUERY
PREHOOK: Input: default@kafka
#### A masked pattern was here ####
POSTHOOK: query: SELECT ngrams(sentences(lower(contents)), 3, 100, 1000).estfrequency FROM kafka
POSTHOOK: type: QUERY
POSTHOOK: Input: default@kafka
#### A masked pattern was here ####
[7.0,6.0,6.0,6.0,6.0,5.0,5.0,5.0,5.0,5.0,5.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,4.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0]
PREHOOK: query: SELECT ngrams(sentences(lower(contents)), 4, 100, 1000).estfrequency FROM kafka
PREHOOK: type: QUERY
PREHOOK: Input: default@kafka
#### A masked pattern was here ####
POSTHOOK: query: SELECT ngrams(sentences(lower(contents)), 4, 100, 1000).estfrequency FROM kafka
POSTHOOK: type: QUERY
POSTHOOK: Input: default@kafka
#### A masked pattern was here ####
[5.0,4.0,4.0,4.0,4.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0]
PREHOOK: query: SELECT ngrams(sentences(lower(contents)), 5, 100, 1000).estfrequency FROM kafka
PREHOOK: type: QUERY
PREHOOK: Input: default@kafka
#### A masked pattern was here ####
POSTHOOK: query: SELECT ngrams(sentences(lower(contents)), 5, 100, 1000).estfrequency FROM kafka
POSTHOOK: type: QUERY
POSTHOOK: Input: default@kafka
#### A masked pattern was here ####
[4.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0]
PREHOOK: query: DROP TABLE kafka
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@kafka
PREHOOK: Output: default@kafka
POSTHOOK: query: DROP TABLE kafka
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@kafka
POSTHOOK: Output: default@kafka
PREHOOK: query: CREATE TABLE ngramtest (col1 INT, col2 STRING)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@ngramtest
POSTHOOK: query: CREATE TABLE ngramtest (col1 INT, col2 STRING)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@ngramtest
PREHOOK: query: INSERT INTO TABLE ngramtest VALUES
(0, 'I am a boy'),
(0, 'I am a girl'),
(0, 'I am an apple'),
(1, 'I am a banana'),
(2, 'We are not animals'),
(0, null)
PREHOOK: type: QUERY
PREHOOK: Input: default@values__tmp__table__1
PREHOOK: Output: default@ngramtest
POSTHOOK: query: INSERT INTO TABLE ngramtest VALUES
(0, 'I am a boy'),
(0, 'I am a girl'),
(0, 'I am an apple'),
(1, 'I am a banana'),
(2, 'We are not animals'),
(0, null)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@values__tmp__table__1
POSTHOOK: Output: default@ngramtest
POSTHOOK: Lineage: ngramtest.col1 EXPRESSION [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col1, type:string, comment:), ]
POSTHOOK: Lineage: ngramtest.col2 SIMPLE [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col2, type:string, comment:), ]
PREHOOK: query: SELECT explode(ngrams(sentences(lower(t.col2)), 2, 10)) as x FROM (SELECT col2 FROM ngramtest WHERE col1=0) t
PREHOOK: type: QUERY
PREHOOK: Input: default@ngramtest
#### A masked pattern was here ####
POSTHOOK: query: SELECT explode(ngrams(sentences(lower(t.col2)), 2, 10)) as x FROM (SELECT col2 FROM ngramtest WHERE col1=0) t
POSTHOOK: type: QUERY
POSTHOOK: Input: default@ngramtest
#### A masked pattern was here ####
{"ngram":["i","am"],"estfrequency":3.0}
{"ngram":["am","a"],"estfrequency":2.0}
{"ngram":["a","boy"],"estfrequency":1.0}
{"ngram":["a","girl"],"estfrequency":1.0}
{"ngram":["am","an"],"estfrequency":1.0}
{"ngram":["an","apple"],"estfrequency":1.0}
PREHOOK: query: DROP TABLE ngramtest
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@ngramtest
PREHOOK: Output: default@ngramtest
POSTHOOK: query: DROP TABLE ngramtest
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@ngramtest
POSTHOOK: Output: default@ngramtest
